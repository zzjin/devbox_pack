# Examples and Use Cases

## Overview

This document provides comprehensive examples of execution plans generated by DevBox Pack for various languages, frameworks, and deployment scenarios. Each example includes the project structure, detection logic, and the resulting execution plan.

## Example Categories

### 1. Node.js Applications

#### Next.js Application

**Project Structure:**
```
node-next/
├── package.json
├── package-lock.json
├── next.config.ts
├── tsconfig.json
├── src/
│   ├── app/
│   │   ├── layout.tsx
│   │   └── page.tsx
│   └── components/
└── public/
```

**Generated Execution Plan:**
```json
{
  "provider": "node",
  "base": {
    "name": ""
  },
  "runtime": {
    "language": "node",
    "version": "20"
  },
  "commands": {
    "dev": ["npm install", "npm run dev"],
    "build": ["npm install", "npm run build"],
    "start": ["npm run start"]
  },
  "port": 3000,
  "evidence": {
    "files": ["package.json", "package-lock.json", "tsconfig.json"],
    "reason": "Detected Node.js project based on: package.json, framework: React"
  }
}
```

**Key Detection Points:**
- `package.json` with Next.js dependencies
- TypeScript configuration files
- React framework detection
- Default port 3000 for Next.js applications

#### Vite React Application

**Project Structure:**
```
node-vite-react/
├── package.json
├── vite.config.ts
├── tsconfig.json
├── index.html
├── src/
│   ├── main.tsx
│   ├── App.tsx
│   └── components/
└── public/
```

**Generated Execution Plan:**
```json
{
  "provider": "node",
  "base": {
    "name": ""
  },
  "runtime": {
    "language": "node",
    "version": "18"
  },
  "commands": {
    "dev": ["npm install", "npm run dev"],
    "build": ["npm install", "npm run build"],
    "start": ["npm run preview"]
  },
  "port": 4173,
  "evidence": {
    "files": ["package.json", "vite.config.ts", "index.html"],
    "reason": "Detected Node.js project based on: package.json, framework: Vite"
  }
}
```

#### Express.js API

**Project Structure:**
```
node-express/
├── package.json
├── server.js
├── routes/
│   ├── api.js
│   └── users.js
└── middleware/
```

**Generated Execution Plan:**
```json
{
  "provider": "node",
  "base": {
    "name": ""
  },
  "runtime": {
    "language": "node",
    "version": "18"
  },
  "commands": {
    "dev": ["npm install", "npm run dev"],
    "build": ["npm install"],
    "start": ["npm start"]
  },
  "port": 3000,
  "evidence": {
    "files": ["package.json", "server.js"],
    "reason": "Detected Node.js project based on: package.json, framework: Express"
  }
}
```

### 2. Python Applications

#### Django Application

**Project Structure:**
```
python-django/
├── pyproject.toml
├── .python-version
├── manage.py
├── requirements.txt
├── myproject/
│   ├── __init__.py
│   ├── settings.py
│   ├── urls.py
│   └── wsgi.py
└── myapp/
    ├── __init__.py
    ├── models.py
    ├── views.py
    └── urls.py
```

**Generated Execution Plan:**
```json
{
  "provider": "python",
  "base": {
    "name": ""
  },
  "runtime": {
    "language": "python",
    "version": "3.11.0"
  },
  "commands": {
    "dev": ["pip install -e .", "python -m http.server 8000"],
    "build": ["pip install ."],
    "start": ["python -m http.server 8000"]
  },
  "port": 8000,
  "evidence": {
    "files": ["pyproject.toml", ".python-version"],
    "reason": "Detected Python project based on: Python source files, pyproject.toml, framework: Django"
  }
}
```

#### FastAPI Application

**Project Structure:**
```
python-fastapi/
├── pyproject.toml
├── requirements.txt
├── main.py
├── app/
│   ├── __init__.py
│   ├── models.py
│   ├── routers/
│   └── dependencies.py
└── tests/
```

**Generated Execution Plan:**
```json
{
  "provider": "python",
  "base": {
    "name": ""
  },
  "runtime": {
    "language": "python",
    "version": "3.11"
  },
  "commands": {
    "dev": ["pip install -r requirements.txt", "uvicorn main:app --reload --host 0.0.0.0 --port 8000"],
    "build": ["pip install -r requirements.txt"],
    "start": ["uvicorn main:app --host 0.0.0.0 --port 8000"]
  },
  "port": 8000,
  "evidence": {
    "files": ["pyproject.toml", "main.py", "requirements.txt"],
    "reason": "Detected Python project based on: Python source files, framework: FastAPI"
  }
}
```

#### Flask Application

**Project Structure:**
```
python-flask/
├── requirements.txt
├── app.py
├── config.py
├── templates/
├── static/
└── tests/
```

**Generated Execution Plan:**
```json
{
  "provider": "python",
  "base": {
    "name": ""
  },
  "runtime": {
    "language": "python",
    "version": "3.10"
  },
  "commands": {
    "dev": ["pip install -r requirements.txt", "flask run --host=0.0.0.0 --port=5000"],
    "build": ["pip install -r requirements.txt"],
    "start": ["flask run --host=0.0.0.0 --port=5000"]
  },
  "port": 5000,
  "evidence": {
    "files": ["requirements.txt", "app.py"],
    "reason": "Detected Python project based on: Python source files, framework: Flask"
  }
}
```

### 3. Go Applications

#### Standard Go Application

**Project Structure:**
```
go-mod/
├── go.mod
├── go.sum
├── main.go
├── handlers/
│   └── api.go
└── models/
    └── user.go
```

**Generated Execution Plan:**
```json
{
  "provider": "go",
  "base": {
    "name": ""
  },
  "runtime": {
    "language": "go",
    "version": "1.23"
  },
  "commands": {
    "dev": ["go mod download", "go run ."],
    "build": ["go mod download", "go build -o app ."],
    "start": ["./app"]
  },
  "port": 8080,
  "evidence": {
    "files": ["go.mod", "go.sum", "main.go"],
    "reason": "Detected Go project based on: go.mod, Go source files"
  }
}
```

#### Go with Multiple Commands

**Project Structure:**
```
go-cmd-dirs/
├── go.mod
├── go.sum
├── cmd/
│   ├── server/
│   │   └── main.go
│   └── worker/
│       └── main.go
├── internal/
└── pkg/
```

**Generated Execution Plan:**
```json
{
  "provider": "go",
  "base": {
    "name": ""
  },
  "runtime": {
    "language": "go",
    "version": "1.23"
  },
  "commands": {
    "dev": ["go mod download", "go run ./cmd/server"],
    "build": ["go mod download", "go build -o server ./cmd/server"],
    "start": ["./server"]
  },
  "port": 8080,
  "evidence": {
    "files": ["go.mod", "cmd/"],
    "reason": "Detected Go project based on: go.mod, cmd directory structure"
  }
}
```

### 4. Java Applications

#### Maven Spring Boot Application

**Project Structure:**
```
java-maven/
├── pom.xml
├── src/
│   ├── main/
│   │   ├── java/
│   │   │   └── com/example/demo/
│   │   │       └── DemoApplication.java
│   │   └── resources/
│   │       └── application.properties
│   └── test/
└── target/
```

**Generated Execution Plan:**
```json
{
  "provider": "java",
  "base": {
    "name": ""
  },
  "runtime": {
    "language": "java",
    "version": "17"
  },
  "commands": {
    "dev": ["./mvnw spring-boot:run"],
    "build": ["./mvnw clean package -DskipTests"],
    "start": ["java -jar target/*.jar"]
  },
  "port": 8080,
  "evidence": {
    "files": ["pom.xml", "src/main/java/"],
    "reason": "Detected Java project based on: pom.xml, Spring Boot framework"
  }
}
```

#### Gradle Application

**Project Structure:**
```
java-gradle/
├── build.gradle.kts
├── settings.gradle.kts
├── gradle/
├── gradlew
├── gradlew.bat
├── src/
│   ├── main/
│   │   └── java/
│   └── test/
└── build/
```

**Generated Execution Plan:**
```json
{
  "provider": "java",
  "base": {
    "name": ""
  },
  "runtime": {
    "language": "java",
    "version": "17"
  },
  "commands": {
    "dev": ["./gradlew bootRun"],
    "build": ["./gradlew build"],
    "start": ["java -jar build/libs/*.jar"]
  },
  "port": 8080,
  "evidence": {
    "files": ["build.gradle.kts", "gradlew"],
    "reason": "Detected Java project based on: Gradle build files"
  }
}
```

### 5. PHP Applications

#### Laravel Application

**Project Structure:**
```
php-laravel/
├── composer.json
├── composer.lock
├── artisan
├── app/
├── config/
├── database/
├── public/
│   └── index.php
├── resources/
├── routes/
└── storage/
```

**Generated Execution Plan:**
```json
{
  "provider": "php",
  "base": {
    "name": ""
  },
  "runtime": {
    "language": "php",
    "version": "8.2"
  },
  "commands": {
    "dev": ["composer install", "php artisan serve --host=0.0.0.0 --port=8000"],
    "build": ["composer install --optimize-autoloader --no-dev"],
    "start": ["php artisan serve --host=0.0.0.0 --port=8000"]
  },
  "port": 8000,
  "evidence": {
    "files": ["composer.json", "artisan"],
    "reason": "Detected PHP project based on: composer.json, Laravel framework"
  }
}
```

### 6. Ruby Applications

#### Rails Application

**Project Structure:**
```
ruby-rails/
├── Gemfile
├── Gemfile.lock
├── config.ru
├── Rakefile
├── app/
├── config/
├── db/
├── public/
└── bin/
    └── rails
```

**Generated Execution Plan:**
```json
{
  "provider": "ruby",
  "base": {
    "name": ""
  },
  "runtime": {
    "language": "ruby",
    "version": "3.2"
  },
  "commands": {
    "dev": ["bundle install", "rails server -b 0.0.0.0 -p 3000"],
    "build": ["bundle install"],
    "start": ["rails server -b 0.0.0.0 -p 3000"]
  },
  "port": 3000,
  "evidence": {
    "files": ["Gemfile", "config.ru", "bin/rails"],
    "reason": "Detected Ruby project based on: Gemfile, Rails framework"
  }
}
```

### 7. Rust Applications

#### Rocket Web Application

**Project Structure:**
```
rust-rocket/
├── Cargo.toml
├── Cargo.lock
├── src/
│   ├── main.rs
│   ├── routes/
│   └── models/
└── target/
```

**Generated Execution Plan:**
```json
{
  "provider": "rust",
  "base": {
    "name": ""
  },
  "runtime": {
    "language": "rust",
    "version": "1.75"
  },
  "commands": {
    "dev": ["cargo run"],
    "build": ["cargo build --release"],
    "start": ["./target/release/rocket-app"]
  },
  "port": 8000,
  "evidence": {
    "files": ["Cargo.toml", "src/main.rs"],
    "reason": "Detected Rust project based on: Cargo.toml, Rocket framework"
  }
}
```

### 8. Static Sites

#### Static HTML/CSS/JS Site

**Project Structure:**
```
staticfile-spa/
├── index.html
├── css/
│   └── style.css
├── js/
│   └── app.js
└── assets/
    └── images/
```

**Generated Execution Plan:**
```json
{
  "provider": "staticfile",
  "base": {
    "name": ""
  },
  "runtime": {
    "language": "staticfile",
    "version": ""
  },
  "commands": {
    "dev": ["python3 -m http.server 8080"],
    "build": [],
    "start": ["python3 -m http.server 8080"]
  },
  "port": 8080,
  "evidence": {
    "files": ["index.html"],
    "reason": "Detected static site based on: HTML files"
  }
}
```

## Advanced Use Cases

### 1. Monorepo Detection

#### Node.js Workspace

**Project Structure:**
```
node-workspaces/
├── package.json
├── packages/
│   ├── frontend/
│   │   ├── package.json
│   │   └── src/
│   ├── backend/
│   │   ├── package.json
│   │   └── src/
│   └── shared/
│       ├── package.json
│       └── lib/
└── apps/
```

**Detection Logic:**
- Detects workspace configuration in root `package.json`
- Identifies primary application based on start scripts
- Generates commands for the main application

### 2. Multi-Language Projects

#### Ruby with Node.js Assets

**Project Structure:**
```
ruby-with-node/
├── Gemfile
├── package.json
├── app/
├── config/
└── frontend/
    ├── src/
    └── dist/
```

**Detection Priority:**
1. Ruby (priority 100) - Primary backend
2. Node.js (priority 90) - Asset compilation

**Generated Plan:**
- Provider: `ruby` (highest priority)
- Commands include both Ruby and Node.js setup
- Asset compilation integrated into build process

### 3. Custom Configuration

#### Project with railpack.json

**Project Structure:**
```
custom-config/
├── railpack.json
├── package.json
├── src/
└── dist/
```

**railpack.json:**
```json
{
  "provider": "node",
  "runtime": {
    "version": "18"
  },
  "commands": {
    "start": "node dist/server.js"
  },
  "port": 4000
}
```

**Behavior:**
- Custom configuration overrides detection
- Specified commands take precedence
- Runtime version can be customized

## Integration Examples

### 1. CI/CD Pipeline

```yaml
# GitHub Actions
name: Deploy
on: [push]

jobs:
  deploy:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v3
      
      - name: Generate Execution Plan
        run: |
          curl -L https://github.com/labring/devbox-pack/releases/latest/download/devbox-pack-linux-amd64 -o devbox-pack
          chmod +x devbox-pack
          ./devbox-pack . --format json > plan.json
      
      - name: Deploy with Plan
        run: |
          # Use generated plan for deployment
          cat plan.json | jq '.commands.build[]' | xargs -I {} sh -c '{}'
```

### 2. Docker Integration

```dockerfile
# Multi-stage build using execution plan
FROM node:18 AS builder
WORKDIR /app
COPY package*.json ./
RUN npm install
COPY . .
RUN npm run build

FROM node:18-alpine
WORKDIR /app
COPY --from=builder /app/dist ./dist
COPY --from=builder /app/node_modules ./node_modules
COPY package*.json ./
EXPOSE 3000
CMD ["npm", "start"]
```

### 3. Development Environment

```bash
#!/bin/bash
# dev-setup.sh

# Generate execution plan
devbox-pack . --format json > .devbox-plan.json

# Extract and run dev commands
jq -r '.commands.dev[]' .devbox-plan.json | while read cmd; do
  echo "Running: $cmd"
  eval "$cmd"
done
```

## Error Handling Examples

### 1. No Provider Detected

**Input:** Empty directory or unsupported language

**Output:**
```json
{
  "error": "No suitable provider detected",
  "suggestions": [
    "Add a package.json for Node.js projects",
    "Add a requirements.txt for Python projects",
    "Add a go.mod for Go projects"
  ]
}
```

### 2. Multiple Providers with Equal Priority

**Input:** Project with both `package.json` and `requirements.txt`

**Behavior:**
- Uses provider priority system
- Node.js (priority 90) vs Python (priority 80)
- Node.js provider selected
- Evidence includes both file types

### 3. Invalid Configuration

**Input:** Malformed `railpack.json`

**Behavior:**
- Falls back to automatic detection
- Logs warning about invalid configuration
- Continues with detected provider

## Best Practices

### 1. Project Structure

**Recommended:**
```
project/
├── package.json          # Clear dependency management
├── .node-version         # Explicit version specification
├── src/                  # Source code organization
├── tests/                # Test organization
└── docs/                 # Documentation
```

### 2. Version Specification

**Explicit Version Files:**
- `.node-version` for Node.js
- `.python-version` for Python
- `.ruby-version` for Ruby
- `rust-toolchain.toml` for Rust

### 3. Framework Detection

**Clear Framework Indicators:**
- Framework-specific configuration files
- Dependency declarations in package managers
- Standard directory structures
- Entry point files

### 4. Port Configuration

**Environment Variable Usage:**
```javascript
// Node.js example
const port = process.env.PORT || 3000;
app.listen(port, '0.0.0.0');
```

```python
# Python example
import os
port = int(os.environ.get('PORT', 8000))
app.run(host='0.0.0.0', port=port)
```

This comprehensive examples guide demonstrates the versatility and accuracy of DevBox Pack's detection and plan generation capabilities across various languages, frameworks, and deployment scenarios.